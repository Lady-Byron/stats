{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@justoverclock/stats/webpack/bootstrap","webpack://@justoverclock/stats/webpack/runtime/compat get default export","webpack://@justoverclock/stats/webpack/runtime/define property getters","webpack://@justoverclock/stats/webpack/runtime/hasOwnProperty shorthand","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/app']\"","webpack://@justoverclock/stats/./src/common/index.ts","webpack://@justoverclock/stats/external root \"flarum.core.compat['forum/app']\"","webpack://@justoverclock/stats/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/extend']\"","webpack://@justoverclock/stats/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@justoverclock/stats/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/Component']\"","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@justoverclock/stats/./src/forum/components/EditModal/EditModal.tsx","webpack://@justoverclock/stats/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@justoverclock/stats/./src/forum/components/SingleUserStat.tsx","webpack://@justoverclock/stats/./src/forum/components/UserStats.tsx","webpack://@justoverclock/stats/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('justoverclock/stats', () => {\n  console.log('[justoverclock/stats] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import Modal, {IInternalModalAttrs} from \"flarum/common/components/Modal\";\nimport Mithril from \"mithril\";\nimport {UserStat} from \"../types\";\nimport User from \"flarum/common/models/User\";\nimport Stream from \"flarum/common/utils/Stream\";\nimport app from 'flarum/forum/app'\n\ninterface StatModalAttrs extends IInternalModalAttrs {\n  stat: UserStat\n  baseStat: any\n  user: User\n  editUserStat: (id: string | number, newValue: string | number) => void\n}\n\nexport default class EditModal extends Modal<StatModalAttrs> {\n  value = Stream('')\n  className(): string {\n    return 'stat-modal-edit';\n  }\n\n  title(): Mithril.Children {\n    return `${this.attrs.baseStat.attributes.name}`;\n  }\n\n  content(): Mithril.Children {\n    const statName = this.attrs.baseStat.attributes.name\n    const username = this.attrs.user.displayName()\n    return (\n      <div className=\"edit-stat-modal-container\">\n        <h3>\n          Set \"{statName}\" for {username}\n        </h3>\n        <input\n          className=\"FormControl\"\n          name={statName}\n          placeholder={app.translator.trans('justoverclock-stats.forum.editStatInputPlaceholder')}\n          type=\"text\"\n          oninput={(e: { target: { value: any } }) => this.value(e.target.value)}\n        />\n        <button\n          onclick={(e: { preventDefault: () => void }) => {\n            e.preventDefault();\n            this.attrs.editUserStat(this.attrs.stat.id, this.value());\n            this.hide()\n          }}\n          className=\"Button Button--primary\"\n        >\n          {app.translator.trans('justoverclock-stats.forum.save')}\n        </button>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Mithril from 'mithril';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\nexport interface SingleUserStatAttrs {\n  name: string;\n  img: string;\n  alt: string;\n  value: string | number;\n  onclick?: () => void;\n}\n\nexport default class SingleUserStat extends Component<SingleUserStatAttrs> {\n  oninit(vnode: Mithril.Vnode<ComponentAttrs, this>) {\n    super.oninit(vnode);\n  }\n\n  view(vnode: Mithril.Vnode<ComponentAttrs, this>): Mithril.Children {\n    return (\n      <div\n        className=\"stat\"\n        onclick={() => {\n          this.attrs.onclick ? this.attrs.onclick() : null;\n        }}\n      >\n        <div className=\"stat-value\">\n          <Tooltip text={this.attrs.name}>\n            <img src={this.attrs.img} alt={this.attrs.alt} />\n          </Tooltip>\n          <p className='stat-desc'>{this.attrs.name}</p>\n          <p class=\"statvalue\">{this.attrs.value}</p>\n        </div>\n      </div>\n    );\n  }\n}\n","// @ts-nocheck\nimport Component, {ComponentAttrs} from \"flarum/common/Component\";\nimport Mithril from \"mithril\";\nimport app from 'flarum/forum/app'\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator'\nimport User from \"flarum/common/models/User\";\nimport {ApiResponse, BaseStat, UserStat} from \"./types\";\nimport EditModal from \"./EditModal/EditModal\";\nimport SingleUserStat from \"./SingleUserStat\";\n\ninterface UserStatsAttrs {\n  user: User\n}\n\nexport default class UserStats extends Component<UserStatsAttrs> {\n  public userStat: ApiResponse | null = null;\n\n  oninit(vnode: Mithril.Vnode<ComponentAttrs, this>) {\n    super.oninit(vnode);\n    this.userStat = null;\n    this.getUserStat();\n\n  }\n\n  view(vnode: Mithril.Vnode<ComponentAttrs, this>): Mithril.Children {\n    if (!this.userStat) {\n      return <LoadingIndicator />;\n    }\n    const { data } = this.attrs.user\n    const moneyName = app.forum.attribute('antoinefr-money.moneyname') || '[money]';\n    const storiesName = app.translator.trans('justoverclock-stats.forum.storyCount');\n    const userMoney = data.attributes.money ?? 0\n    const userStoriesCount = data.attributes.storyCount ?? 0\n    const moneyImg =  `${app.forum.attribute('baseUrl')}/assets/extensions/justoverclock-stats/money1.png`\n    const storiesImg =  `${app.forum.attribute('baseUrl')}/assets/extensions/justoverclock-stats/storiespng.png`\n    const canEditStats: boolean = data.attributes?.canEditStats\n\n    return (\n      <div className='show-stats-wrapper'>\n        <div className='user-stats-fe container show-stats-container'>\n          <SingleUserStat\n            name={moneyName}\n            img={app.forum.attribute('justoverclock-stats.moneyImg') || moneyImg}\n            alt={moneyName}\n            value={userMoney}\n          />\n          <SingleUserStat\n            name={storiesName}\n            img={app.forum.attribute('justoverclock-stats.storiesImg') || storiesImg}\n            alt={storiesName}\n            value={userStoriesCount}\n          />\n          {this.userStat.data && this.userStat.data.map((stat: UserStat) => {\n            const baseStat: BaseStat | null | undefined = this.userStat && this.userStat.included.find(\n              baseStat => baseStat.id.toString() === stat.attributes.baseStatId.toString()\n            );\n            const imgPath = baseStat ? baseStat.attributes.img : \"\";\n\n\n            return (\n              <SingleUserStat\n                name={baseStat?.attributes.name}\n                img={imgPath}\n                alt={baseStat?.attributes.name}\n                value={stat.attributes.value}\n                onclick={() => {\n                  canEditStats ? this.openEditModal(stat, baseStat, this.attrs.user) : null;\n                }}\n              />\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n\n  openEditModal(stat: UserStat, baseStat: any, user: User) {\n    app.modal.show(EditModal, {\n      stat,\n      baseStat,\n      user,\n      editUserStat: this.editUserStat.bind(this)\n    })\n  }\n\n  editUserStat(id: string | number, newValue: string | number) {\n    app.request({\n      method: 'PATCH',\n      url: `${app.forum.attribute('apiUrl')}/user-stats/${id}`,\n      body: {\n        data: {\n          attributes: {\n            value: Number(newValue)\n          }\n        }\n      }\n    }).then(() => {\n      app.alerts.show({type: 'success'}, app.translator.trans('justoverclock-stats.forum.successStatEdited'))\n    })\n  }\n\n  getUserStat() {\n    app.request({\n      method: 'GET',\n      url: `${app.forum.attribute('apiUrl')}/user-stats/${this.attrs.user.data.id}`,\n    }).then(res => {\n      this.userStat = res as ApiResponse;\n      m.redraw()\n    })\n  }\n}\n","// @ts-nocheck\nimport app from 'flarum/forum/app';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport { extend } from 'flarum/common/extend';\nimport UserStats from \"./components/UserStats\";\n\napp.initializers.add('justoverclock/stats', () => {\n  extend(UserCard.prototype, 'view', function (vdom){\n    if (vdom.children && vdom.children.splice) {\n      vdom.children.splice(1,0, <UserStats user={this.attrs.user} />)\n    }\n  })\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","console","log","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","EditModal","_Modal","_this","_len","arguments","length","args","Array","_key","apply","concat","value","Stream","_proto","className","title","this","attrs","baseStat","attributes","name","content","_this2","statName","username","user","displayName","m","placeholder","trans","type","oninput","target","onclick","preventDefault","editUserStat","stat","id","hide","Modal","SingleUserStat","_Component","oninit","vnode","view","Tooltip","text","src","img","alt","class","Component","UserStats","userStat","getUserStat","_data$attributes$mone","_data$attributes$stor","_data$attributes","LoadingIndicator","data","moneyName","attribute","storiesName","userMoney","money","userStoriesCount","storyCount","moneyImg","storiesImg","canEditStats","map","included","find","toString","baseStatId","imgPath","openEditModal","show","newValue","method","url","body","Number","then","_this3","res","redraw","extend","UserCard","vdom","children","splice"],"sourceRoot":""}